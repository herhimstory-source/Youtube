import React, { useState, useEffect } from 'react';
import { Copy, Sparkles, TrendingUp, Video, Calendar, Tag, Heart, Zap, Users, Target, RefreshCw, Edit3, Check, Globe, Download, Smartphone } from 'lucide-react';

const YoutubeMentionGenerator = () => {
  const [formData, setFormData] = useState({
    keywords: '',
    date: '',
    videoType: 'shorts',
    sport: '',
    emotion: 'excited',
    trendElement: 'storytelling',
    achievement: '',
    challenge: ''
  });

  const [generatedMention, setGeneratedMention] = useState('');
  const [editedMention, setEditedMention] = useState('');
  const [translatedMention, setTranslatedMention] = useState('');
  const [copied, setCopied] = useState(false);
  const [editMode, setEditMode] = useState(false);
  const [translating, setTranslating] = useState(false);
  const [deferredPrompt, setDeferredPrompt] = useState(null);
  const [showInstallPrompt, setShowInstallPrompt] = useState(false);

  // PWA 설치 프롬프트 처리
  useEffect(() => {
    const handleBeforeInstallPrompt = (e) => {
      e.preventDefault();
      setDeferredPrompt(e);
      setShowInstallPrompt(true);
    };

    window.addEventListener('beforeinstallprompt', handleBeforeInstallPrompt);

    // 이미 설치된 경우 확인
    if (window.matchMedia('(display-mode: standalone)').matches) {
      setShowInstallPrompt(false);
    }

    return () => {
      window.removeEventListener('beforeinstallprompt', handleBeforeInstallPrompt);
    };
  }, []);

  const handleInstallClick = async () => {
    if (deferredPrompt) {
      deferredPrompt.prompt();
      const { outcome } = await deferredPrompt.userChoice;
      if (outcome === 'accepted') {
        setShowInstallPrompt(false);
      }
      setDeferredPrompt(null);
    }
  };

  const videoTypes = [
    { value: 'shorts', label: 'YouTube Shorts (15-60초)', icon: '📱' },
    { value: 'regular', label: '일반 영상 (3-8분)', icon: '🎥' },
    { value: 'live', label: '라이브 스트림', icon: '🔴' },
    { value: 'series', label: '시리즈 영상', icon: '📺' }
  ];

  const emotions = [
    { value: 'excited', label: '흥미진진한', emoji: '🔥' },
    { value: 'grateful', label: '감사한', emoji: '🙏' },
    { value: 'determined', label: '의지에 찬', emoji: '💪' },
    { value: 'reflective', label: '돌아보는', emoji: '💭' },
    { value: 'proud', label: '자랑스러운', emoji: '✨' }
  ];

  const trendElements = [
    { value: 'storytelling', label: '스토리텔링', desc: '개인적 여정 공유' },
    { value: 'behind-scenes', label: '비하인드 신', desc: '훈련 과정 공개' },
    { value: 'mental-health', label: '멘탈 케어', desc: '정신 건강 중시' },
    { value: 'community', label: '커뮤니티', desc: '팬과의 소통' },
    { value: 'tech-data', label: '데이터 활용', desc: '기술적 분석' },
    { value: 'challenge', label: '챌린지', desc: '바이럴 참여' }
  ];

  const trendingHashtags2025 = [
    '#Shorts', '#주니어선수', '#성장스토리', '#꿈을향해', '#멘탈강화',
    '#데이터분석', '#커뮤니티', '#진정성', '#비하인드', '#라이브소통',
    '#스토리텔링', '#영감', '#도전', '#극복', '#팀워크'
  ];

  const translateToEnglish = (koreanText) => {
    let translatedText = koreanText;

    // 1단계: 완전한 문장 패턴 번역 (먼저 처리)
    const sentencePatterns = [
      // 감정적 훅 문장들
      { from: /🔥\s*이\s*순간을\s*위해\s*얼마나\s*기다렸는지\.{3}/g, to: '🔥 How long I\'ve been waiting for this moment...' },
      { from: /⚡\s*드디어\s*해냈다!/g, to: '⚡ Finally made it!' },
      { from: /🚀\s*상상도\s*못했던\s*일이\.{3}/g, to: '🚀 Something I never imagined...' },
      { from: /🙏\s*모든\s*분들\s*덕분에\.{3}/g, to: '🙏 Thanks to everyone...' },
      { from: /❤️\s*정말\s*감사한\s*마음으로\.{3}/g, to: '❤️ With a truly grateful heart...' },
      { from: /✨\s*이런\s*기회를\s*주신\.{3}/g, to: '✨ For giving me this opportunity...' },
      { from: /💪\s*포기하지\s*않길\s*정말\s*잘했어요/g, to: '💪 I\'m so glad I didn\'t give up' },
      { from: /🎯\s*목표를\s*향한\s*한\s*걸음/g, to: '🎯 One step towards the goal' },
      { from: /⚡\s*더\s*강해지기\s*위해\.{3}/g, to: '⚡ To become stronger...' },
      { from: /💭\s*돌이켜보면\.{3}/g, to: '💭 Looking back...' },
      { from: /📖\s*그때\s*그\s*순간이\.{3}/g, to: '📖 That moment back then...' },
      { from: /🌟\s*이\s*여정을\s*통해\s*배운\s*것은\.{3}/g, to: '🌟 What I learned through this journey...' },
      { from: /✨\s*자랑스러운\s*순간/g, to: '✨ A proud moment' },
      { from: /🏆\s*이\s*성과가\s*의미하는\s*것은\.{3}/g, to: '🏆 What this achievement means...' },
      { from: /🌟\s*드디어\s*이루어낸\.{3}/g, to: '🌟 Finally achieved...' },

      // 스토리 문장들
      { from: /📖\s*(.+?)를\s*처음\s*시작했을\s*때만\s*해도\s*이런\s*날이\s*올\s*줄\s*몰랐어요\./g, to: '📖 When I first started $1, I never knew this day would come.' },
      { from: /📚\s*예전의\s*저에게\s*말해주고\s*싶어요\.\s*"(.+?)에서\s*포기하지\s*마,\s*네가\s*꿈꾸던\s*그\s*순간이\s*정말\s*올\s*거야"라고요\./g, to: '📚 I want to tell my past self: "Don\'t give up on $1, that moment you dreamed of will really come."' },
      { from: /🏃‍♀️\s*카메라에\s*담기지\s*않은\s*새벽\s*훈련,\s*쓰라린\s*실패들\.\.\.\s*그\s*모든\s*과정이\s*오늘의\s*(.+?)를\s*만들었어요\./g, to: '🏃‍♀️ Dawn training not captured on camera, bitter failures... All of that process created today\'s $1.' },
      { from: /⏰\s*새벽\s*5시\s*훈련장,\s*아무도\s*보지\s*않는\s*곳에서의\s*노력들이\s*드디어\s*빛을\s*보는\s*순간입니다\./g, to: '⏰ 5 AM training ground, efforts in places no one saw are finally coming to light.' },
      { from: /🧠\s*몸만큼\s*마음도\s*단단해져야\s*한다는\s*걸\s*배웠어요\./g, to: '🧠 I learned that the mind needs to be as strong as the body.' },
      { from: /💚\s*선수로서의\s*성장뿐만\s*아니라\s*한\s*사람으로서의\s*성장도\s*중요하다는\s*걸\s*깨달았습니다\./g, to: '💚 I realized that growth as a person is as important as growth as an athlete.' },
      { from: /👥\s*혼자서는\s*절대\s*할\s*수\s*없었을\s*일이에요\.\s*응원해주신\s*모든\s*분들과\s*함께\s*이뤄낸\s*성과입니다!/g, to: '👥 This is something I could never have done alone. This achievement was made together with everyone who supported me!' },
      { from: /🤝\s*댓글로\s*격려해주시고,\s*라이브에서\s*함께해주신\s*모든\s*분들\s*덕분에\s*여기까지\s*올\s*수\s*있었어요\./g, to: '🤝 Thanks to everyone who encouraged me in the comments and joined me in live streams, I was able to come this far.' },
      { from: /📊\s*데이터가\s*보여준\s*작은\s*변화들이\s*결국\s*큰\s*성과로\s*이어졌어요\./g, to: '📊 The small changes shown by the data eventually led to big achievements.' },
      { from: /⌚\s*웨어러블\s*기기가\s*알려준\s*제\s*한계를\s*하나씩\s*뛰어넘는\s*재미가\s*있어요\./g, to: '⌚ There\'s joy in overcoming the limits that wearable devices showed me, one by one.' },
      { from: /🎯\s*(.+?)\s*챌린지에\s*참여하면서\s*새로운\s*가능성을\s*발견했어요!/g, to: '🎯 I discovered new possibilities while participating in the $1 challenge!' },
      { from: /🌟\s*트렌드에\s*맞춰\s*도전해보니\s*예상치\s*못한\s*재미와\s*성장이\s*있었습니다\./g, to: '🌟 Challenging myself according to trends brought unexpected fun and growth.' },

      // 교훈 문장들
      { from: /⚡\s*(.+?)를\s*통해\s*배운\s*가장\s*큰\s*교훈은\s*'꾸준함이\s*재능을\s*이긴다'는\s*것/g, to: '⚡ The biggest lesson I learned through $1 is that \'consistency beats talent\'' },
      { from: /🎯\s*실패를\s*두려워하지\s*않고\s*도전하는\s*용기가\s*가장\s*중요한\s*자산/g, to: '🎯 The courage to challenge without fearing failure is the most important asset' },
      { from: /💡\s*완벽하지\s*않아도\s*괜찮다,\s*성장하는\s*과정\s*자체가\s*아름답다/g, to: '💡 It\'s okay not to be perfect, the process of growth itself is beautiful' },
      { from: /🌟\s*경쟁보다는\s*어제의\s*나와의\s*비교가\s*진정한\s*성장의\s*기준/g, to: '🌟 Comparing with yesterday\'s self rather than competition is the true measure of growth' },
      { from: /🤝\s*혼자가\s*아니라\s*함께할\s*때\s*더\s*큰\s*힘이\s*나온다는\s*것/g, to: '🤝 Greater strength comes from being together, not alone' },

      // 목표 문장들
      { from: /🎯\s*다음\s*목표는\s*(.+?)에서\s*한\s*단계\s*더\s*성장하는\s*것/g, to: '🎯 My next goal is to grow one step further in $1' },
      { from: /🚀\s*이번\s*경험을\s*바탕으로\s*더\s*큰\s*무대에\s*도전하고\s*싶어요/g, to: '🚀 Based on this experience, I want to challenge myself on a bigger stage' },
      { from: /💪\s*꾸준한\s*훈련으로\s*내년에는\s*더\s*발전된\s*모습\s*보여드릴게요/g, to: '💪 Through consistent training, I\'ll show you a more improved version next year' },
      { from: /🌟\s*후배들에게도\s*좋은\s*롤모델이\s*되고\s*싶습니다/g, to: '🌟 I want to be a good role model for my juniors' },
      { from: /⭐\s*궁극적으로는\s*(.+?)에서\s*최고가\s*되는\s*그날까지/g, to: '⭐ Ultimately, until the day I become the best in $1' },

      // 영상 타입 문장들
      { from: /📱\s*60초로\s*압축한\s*이\s*순간,\s*놓치지\s*마세요!/g, to: '📱 This moment compressed into 60 seconds, don\'t miss it!' },
      { from: /🎥\s*자세한\s*이야기는\s*영상에서\s*확인해주세요!/g, to: '🎥 Check out the video for the detailed story!' },
      { from: /🔴\s*실시간으로\s*여러분과\s*나누고\s*싶었던\s*이야기/g, to: '🔴 A story I wanted to share with you in real time' },
      { from: /📺\s*시리즈로\s*계속\s*이어집니다,\s*다음\s*편도\s*기대해주세요!/g, to: '📺 This series continues, please look forward to the next episode!' }
    ];

    // 2단계: 개별 단어/구문 번역
    const wordTranslations = {
      // 일반 단어
      '그리고': 'and', '또한': 'also', '하지만': 'but', '그러나': 'however',
      '때문에': 'because of', '덕분에': 'thanks to', '통해': 'through',
      '위해': 'for', '함께': 'together', '혼자': 'alone',
      '정말': 'really', '너무': 'so', '매우': 'very', '조금': 'a little',
      '많이': 'a lot', '전혀': 'not at all', '항상': 'always', '가끔': 'sometimes',
      '오늘': 'today', '어제': 'yesterday', '내일': 'tomorrow',
      '지금': 'now', '나중에': 'later', '먼저': 'first',
      '마지막': 'last', '처음': 'first time',
      
      // 감정/상태
      '기쁘다': 'happy', '슬프다': 'sad', '화나다': 'angry',
      '놀라다': 'surprised', '걱정': 'worry', '불안': 'anxious',
      '자신감': 'confidence', '용기': 'courage', '희망': 'hope',
      '꿈': 'dream', '목표': 'goal', '성과': 'achievement',
      '실패': 'failure', '성공': 'success', '노력': 'effort',
      
      // 스포츠 관련
      '선수': 'athlete', '코치': 'coach', '팀': 'team',
      '경기': 'game', '시합': 'match', '대회': 'tournament',
      '훈련': 'training', '연습': 'practice', '기록': 'record',
      '우승': 'championship', '승리': 'victory', '패배': 'defeat',
      '실력': 'skill', '기술': 'technique', '전술': 'tactics',
      
      // 시간 표현
      '년': 'year', '월': 'month', '일': 'day',
      '시간': 'time', '분': 'minute', '초': 'second',
      '새벽': 'dawn', '아침': 'morning', '오후': 'afternoon',
      '저녁': 'evening', '밤': 'night',
      
      // 장소
      '훈련장': 'training ground', '경기장': 'stadium',
      '학교': 'school', '집': 'home', '체육관': 'gym',
      
      // 사람
      '가족': 'family', '부모님': 'parents', '친구': 'friends',
      '선배': 'senior', '후배': 'junior', '동료': 'colleague',
      '팬': 'fan', '관객': 'audience',
      
      // 기타 표현
      '정말로': 'really', '진짜': 'really', '사실': 'actually',
      '물론': 'of course', '아마': 'probably', '확실히': 'definitely',
      '계속': 'continue', '시작': 'start', '끝': 'end',
      '과정': 'process', '결과': 'result', '경험': 'experience',
      '기회': 'opportunity', '순간': 'moment', '시기': 'timing',
      
      // 동사들
      '하다': 'do', '되다': 'become', '가다': 'go',
      '오다': 'come', '보다': 'see', '듣다': 'hear',
      '말하다': 'say', '생각하다': 'think', '느끼다': 'feel',
      '배우다': 'learn', '가르치다': 'teach', '돕다': 'help',
      '만들다': 'make', '찾다': 'find', '잃다': 'lose',
      '이기다': 'win', '지다': 'lose', '도전하다': 'challenge',
      
      // 조사/어미 처리
      '을': '', '를': '', '이': '', '가': '',
      '에': '', '에서': '', '로': '', '으로': '',
      '와': 'and', '과': 'and', '하고': 'and',
      '입니다': '', '해요': '', '어요': '', '네요': '',
      '습니다': '', '해야': 'should', '할게요': 'I will',
      
      // 해시태그
      '#주니어선수': '#JuniorAthlete',
      '#성장스토리': '#GrowthStory',
      '#꿈을향해': '#TowardTheDream',
      '#멘탈강화': '#MentalStrength',
      '#데이터분석': '#DataAnalysis',
      '#커뮤니티': '#Community',
      '#진정성': '#Authenticity',
      '#비하인드': '#BehindTheScenes',
      '#라이브소통': '#LiveCommunication',
      '#스토리텔링': '#Storytelling',
      '#영감': '#Inspiration',
      '#도전': '#Challenge',
      '#극복': '#Overcome',
      '#팀워크': '#Teamwork',
      '#2025트렌드': '#2025Trends',
      '#유튜브': '#YouTube'
    };

    // 1단계 적용: 완전한 문장 패턴
    sentencePatterns.forEach(({ from, to }) => {
      translatedText = translatedText.replace(from, to);
    });

    // 2단계 적용: 개별 단어 번역
    Object.entries(wordTranslations).forEach(([korean, english]) => {
      if (english) { // 빈 문자열이 아닌 경우만
        const regex = new RegExp(`\\b${korean.replace(/[.*+?^${}()|[\]\\]/g, '\\$&')}\\b`, 'g');
        translatedText = translatedText.replace(regex, english);
      } else {
        // 조사 제거
        const regex = new RegExp(korean.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
        translatedText = translatedText.replace(regex, '');
      }
    });

    // 3단계: 남은 한글 처리 (기본적인 패턴)
    translatedText = translatedText.replace(/([가-힣]+)하며/g, 'while $1ing');
    translatedText = translatedText.replace(/([가-힣]+)했던/g, '$1 that I did');
    translatedText = translatedText.replace(/([가-힣]+)한다는/g, 'that I $1');
    translatedText = translatedText.replace(/([가-힣]+)하는/g, '$1ing');
    translatedText = translatedText.replace(/([가-힣]+)했어요/g, 'I $1ed');
    translatedText = translatedText.replace(/([가-힣]+)할게요/g, 'I will $1');
    translatedText = translatedText.replace(/([가-힣]+)하고/g, '$1 and');

    // 4단계: 문법 정리
    translatedText = translatedText.replace(/\s+/g, ' '); // 중복 공백 제거
    translatedText = translatedText.replace(/\s+([.!?])/g, '$1'); // 문장부호 앞 공백 제거
    translatedText = translatedText.trim(); // 앞뒤 공백 제거

    return translatedText;
  };

  const handleTranslate = async () => {
    setTranslating(true);
    await new Promise(resolve => setTimeout(resolve, 1500));
    const translated = translateToEnglish(editedMention || generatedMention);
    setTranslatedMention(translated);
    setTranslating(false);
  };

  const handleEditMode = () => {
    setEditMode(true);
    setEditedMention(generatedMention);
  };

  const handleSaveEdit = () => {
    setEditMode(false);
    setTranslatedMention('');
  };

  const handleCancelEdit = () => {
    setEditMode(false);
    setEditedMention('');
  };

  const copyToClipboard = (text) => {
    navigator.clipboard.writeText(text || editedMention || generatedMention);
    setCopied(true);
    setTimeout(() => setCopied(false), 2000);
  };

  const generateMention = () => {
    const hooks = {
      excited: ['🔥 이 순간을 위해 얼마나 기다렸는지...', '⚡ 드디어 해냈다!', '🚀 상상도 못했던 일이...'],
      grateful: ['🙏 모든 분들 덕분에...', '❤️ 정말 감사한 마음으로...', '✨ 이런 기회를 주신...'],
      determined: ['💪 포기하지 않길 정말 잘했어요', '🎯 목표를 향한 한 걸음', '⚡ 더 강해지기 위해...'],
      reflective: ['💭 돌이켜보면...', '📖 그때 그 순간이...', '🌟 이 여정을 통해 배운 것은...'],
      proud: ['✨ 자랑스러운 순간', '🏆 이 성과가 의미하는 것은...', '🌟 드디어 이루어낸...']
    };

    const storyElements = {
      storytelling: [
        `📖 ${formData.keywords}를 처음 시작했을 때만 해도 이런 날이 올 줄 몰랐어요. 매일 ${formData.challenge || '훈련'}하며 느꼈던 그 순간들이 오늘 ${formData.achievement || '이 성과'}로 이어졌습니다.`,
        `📚 예전의 저에게 말해주고 싶어요. "${formData.keywords}에서 포기하지 마, 네가 꿈꾸던 그 순간이 정말 올 거야"라고요.`
      ],
      'behind-scenes': [
        `🏃‍♀️ 카메라에 담기지 않은 새벽 훈련, 쓰라린 실패들... 그 모든 과정이 오늘의 ${formData.achievement || '성과'}를 만들었어요.`,
        `⏰ 새벽 5시 훈련장, 아무도 보지 않는 곳에서의 노력들이 드디어 빛을 보는 순간입니다.`
      ],
      'mental-health': [
        `🧠 몸만큼 마음도 단단해져야 한다는 걸 배웠어요. 압박감과 스트레스를 이겨내는 것도 실력의 일부라는 것을...`,
        `💚 선수로서의 성장뿐만 아니라 한 사람으로서의 성장도 중요하다는 걸 깨달았습니다.`
      ],
      community: [
        `👥 혼자서는 절대 할 수 없었을 일이에요. 응원해주신 모든 분들과 함께 이뤄낸 성과입니다!`,
        `🤝 댓글로 격려해주시고, 라이브에서 함께해주신 모든 분들 덕분에 여기까지 올 수 있었어요.`
      ],
      'tech-data': [
        `📊 데이터가 보여준 작은 변화들이 결국 큰 성과로 이어졌어요. 수치로 확인하니 더욱 뿌듯합니다!`,
        `⌚ 웨어러블 기기가 알려준 제 한계를 하나씩 뛰어넘는 재미가 있어요.`
      ],
      challenge: [
        `🎯 ${formData.keywords} 챌린지에 참여하면서 새로운 가능성을 발견했어요!`,
        `🌟 트렌드에 맞춰 도전해보니 예상치 못한 재미와 성장이 있었습니다.`
      ]
    };

    const insights = [
      `⚡ ${formData.keywords}를 통해 배운 가장 큰 교훈은 '꾸준함이 재능을 이긴다'는 것`,
      `🎯 실패를 두려워하지 않고 도전하는 용기가 가장 중요한 자산`,
      `💡 완벽하지 않아도 괜찮다, 성장하는 과정 자체가 아름답다`,
      `🌟 경쟁보다는 어제의 나와의 비교가 진정한 성장의 기준`,
      `🤝 혼자가 아니라 함께할 때 더 큰 힘이 나온다는 것`
    ];

    const nextGoals = [
      `🎯 다음 목표는 ${formData.keywords}에서 한 단계 더 성장하는 것`,
      `🚀 이번 경험을 바탕으로 더 큰 무대에 도전하고 싶어요`,
      `💪 꾸준한 훈련으로 내년에는 더 발전된 모습 보여드릴게요`,
      `🌟 후배들에게도 좋은 롤모델이 되고 싶습니다`,
      `⭐ 궁극적으로는 ${formData.sport}에서 최고가 되는 그날까지`
    ];

    const videoTypeTexts = {
      shorts: '📱 60초로 압축한 이 순간, 놓치지 마세요!',
      regular: '🎥 자세한 이야기는 영상에서 확인해주세요!',
      live: '🔴 실시간으로 여러분과 나누고 싶었던 이야기',
      series: '📺 시리즈로 계속 이어집니다, 다음 편도 기대해주세요!'
    };

    const selectedHook = hooks[formData.emotion][Math.floor(Math.random() * hooks[formData.emotion].length)];
    const selectedStory = storyElements[formData.trendElement][Math.floor(Math.random() * storyElements[formData.trendElement].length)];
    const selectedInsight = insights[Math.floor(Math.random() * insights.length)];
    const selectedGoal = nextGoals[Math.floor(Math.random() * nextGoals.length)];
    const videoTypeText = videoTypeTexts[formData.videoType];
    
    const selectedHashtags = trendingHashtags2025
      .sort(() => 0.5 - Math.random())
      .slice(0, 8)
      .join(' ');

    const mention = `${selectedHook}

${selectedStory}

${selectedInsight}
${selectedGoal}

${videoTypeText}

${selectedHashtags}

#${formData.sport} #2025트렌드 #유튜브`;

    setGeneratedMention(mention);
    setEditMode(false);
    setEditedMention('');
    setTranslatedMention('');
  };

  const handleInputChange = (field, value) => {
    setFormData(prev => ({ ...prev, [field]: value }));
  };

  return (
    <>
      {/* PWA Meta Tags */}
      <div style={{ display: 'none' }}>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta name="theme-color" content="#1e1b4b" />
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
        <meta name="apple-mobile-web-app-title" content="멘션생성기" />
        <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg==" />
        <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoi7Jyg7Yqc67isMDI1IO2KuOujjOuTnCDrqanlhZjshZnshLHquLAiLCJzaG9ydF9uYW1lIjoi66mY7Zy46ICs7IO16IC16riAIiwic3RhcnRfdXJsIjoiLyIsImRpc3BsYXkiOiJzdGFuZGFsb25lIiwidGhlbWVfY29sb3IiOiIjMWUxYjRiIiwiYmFja2dyb3VuZF9jb2xvciI6IiMxZTFiNGIiLCJpY29ucyI6W3sic3JjIjoiZGF0YTppbWFnZS9wbmc7YmFzZTY0LGlWQk9SdzBLR2dvQUFBQU5TVWhFVWdBQUFBRUFBQUFCQ0FZQUFBQWZGY1NKQUFBQURVbEVRVlI0Mm1OaysrTVFEd0FEaGdHQVdqUjlhd0FBQUFCSlJVNUVya0pnZ2c9PSIsInNpemVzIjoiNTEyeDUxMiIsInR5cGUiOiJpbWFnZS9wbmciLCJwdXJwb3NlIjoiYW55IG1hc2thYmxlIn1dfQ==" />
      </div>

      <div className="min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 p-3 sm:p-6">
        <div className="max-w-4xl mx-auto">
          {/* PWA 설치 알림 */}
          {showInstallPrompt && (
            <div className="fixed top-4 left-4 right-4 z-50 bg-gradient-to-r from-green-500 to-emerald-600 text-white p-4 rounded-lg shadow-lg flex items-center justify-between">
              <div className="flex items-center gap-3">
                <Smartphone className="w-6 h-6" />
                <div>
                  <div className="font-semibold">홈 화면에 추가하기</div>
                  <div className="text-sm opacity-90">언제든 빠르게 접근하세요!</div>
                </div>
              </div>
              <div className="flex gap-2">
                <button
                  onClick={handleInstallClick}
                  className="bg-white text-green-600 px-4 py-2 rounded-lg font-semibold text-sm hover:bg-gray-100 transition-colors"
                >
                  설치
                </button>
                <button
                  onClick={() => setShowInstallPrompt(false)}
                  className="text-white opacity-70 hover:opacity-100 p-2"
                >
                  ✕
                </button>
              </div>
            </div>
          )}

          {/* Header */}
          <div className="text-center mb-6 sm:mb-8">
            <div className="flex items-center justify-center gap-2 sm:gap-3 mb-3 sm:mb-4">
              <TrendingUp className="w-6 sm:w-8 h-6 sm:h-8 text-yellow-400" />
              <h1 className="text-2xl sm:text-4xl font-bold text-white">유튜브 트렌드 멘션 생성기</h1>
              <Sparkles className="w-6 sm:w-8 h-6 sm:h-8 text-yellow-400" />
            </div>
            <p className="text-blue-200 text-sm sm:text-lg">2025년 최신 트렌드를 반영한 스마트 멘션 제작 도구</p>
            
            {/* 모바일 설치 안내 */}
            <div className="mt-4 bg-white/10 backdrop-blur-lg rounded-lg p-3 border border-white/20 block sm:hidden">
              <div className="flex items-center justify-center gap-2 text-blue-200 text-xs">
                <Download className="w-4 h-4" />
                <span>홈 화면에 추가하여 앱처럼 사용하세요!</span>
              </div>
            </div>
          </div>

          <div className="grid lg:grid-cols-2 gap-4 sm:gap-8">
            {/* Input Form */}
            <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-4 sm:p-6 border border-white/20">
              <h2 className="text-xl sm:text-2xl font-semibold text-white mb-4 sm:mb-6 flex items-center gap-2">
                <Tag className="w-5 sm:w-6 h-5 sm:h-6" />
                콘텐츠 정보 입력
              </h2>

              <div className="space-y-4 sm:space-y-6">
                {/* Keywords */}
                <div>
                  <label className="block text-white font-medium mb-2 text-sm sm:text-base">핵심 키워드</label>
                  <input
                    type="text"
                    value={formData.keywords}
                    onChange={(e) => handleInputChange('keywords', e.target.value)}
                    placeholder="예: 축구, 수영, 농구 등"
                    className="w-full p-2 sm:p-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-transparent text-sm sm:text-base"
                  />
                </div>

                {/* Sport */}
                <div>
                  <label className="block text-white font-medium mb-2 text-sm sm:text-base">스포츠 종목</label>
                  <input
                    type="text"
                    value={formData.sport}
                    onChange={(e) => handleInputChange('sport', e.target.value)}
                    placeholder="구체적인 종목명 입력"
                    className="w-full p-2 sm:p-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-transparent text-sm sm:text-base"
                  />
                </div>

                {/* Date */}
                <div>
                  <label className="block text-white font-medium mb-2 flex items-center gap-2 text-sm sm:text-base">
                    <Calendar className="w-4 h-4" />
                    날짜
                  </label>
                  <input
                    type="date"
                    value={formData.date}
                    onChange={(e) => handleInputChange('date', e.target.value)}
                    className="w-full p-2 sm:p-3 rounded-lg bg-white/20 border border-white/30 text-white focus:ring-2 focus:ring-blue-400 focus:border-transparent text-sm sm:text-base"
                  />
                </div>

                {/* Achievement */}
                <div>
                  <label className="block text-white font-medium mb-2 text-sm sm:text-base">주요 성과/순간</label>
                  <input
                    type="text"
                    value={formData.achievement}
                    onChange={(e) => handleInputChange('achievement', e.target.value)}
                    placeholder="예: 개인 최고 기록 달성, 첫 승리 등"
                    className="w-full p-2 sm:p-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-transparent text-sm sm:text-base"
                  />
                </div>

                {/* Challenge */}
                <div>
                  <label className="block text-white font-medium mb-2 text-sm sm:text-base">극복한 어려움</label>
                  <input
                    type="text"
                    value={formData.challenge}
                    onChange={(e) => handleInputChange('challenge', e.target.value)}
                    placeholder="예: 부상 회복, 슬럼프 극복 등"
                    className="w-full p-2 sm:p-3 rounded-lg bg-white/20 border border-white/30 text-white placeholder-gray-300 focus:ring-2 focus:ring-blue-400 focus:border-transparent text-sm sm:text-base"
                  />
                </div>

                {/* Video Type */}
                <div>
                  <label className="block text-white font-medium mb-2 flex items-center gap-2 text-sm sm:text-base">
                    <Video className="w-4 h-4" />
                    영상 타입
                  </label>
                  <div className="grid grid-cols-1 gap-2">
                    {videoTypes.map((type) => (
                      <label key={type.value} className="flex items-center gap-3 p-2 sm:p-3 rounded-lg bg-white/10 hover:bg-white/20 cursor-pointer transition-colors">
                        <input
                          type="radio"
                          name="videoType"
                          value={type.value}
                          checked={formData.videoType === type.value}
                          onChange={(e) => handleInputChange('videoType', e.target.value)}
                          className="text-blue-500"
                        />
                        <span className="text-lg">{type.icon}</span>
                        <span className="text-white text-sm sm:text-base">{type.label}</span>
                      </label>
                    ))}
                  </div>
                </div>

                {/* Emotion */}
                <div>
                  <label className="block text-white font-medium mb-2 flex items-center gap-2 text-sm sm:text-base">
                    <Heart className="w-4 h-4" />
                    감정/톤
                  </label>
                  <div className="grid grid-cols-2 gap-2">
                    {emotions.map((emotion) => (
                      <label key={emotion.value} className="flex items-center gap-2 p-2 rounded-lg bg-white/10 hover:bg-white/20 cursor-pointer transition-colors">
                        <input
                          type="radio"
                          name="emotion"
                          value={emotion.value}
                          checked={formData.emotion === emotion.value}
                          onChange={(e) => handleInputChange('emotion', e.target.value)}
                          className="text-blue-500"
                        />
                        <span>{emotion.emoji}</span>
                        <span className="text-white text-xs sm:text-sm">{emotion.label}</span>
                      </label>
                    ))}
                  </div>
                </div>

                {/* Trend Element */}
                <div>
                  <label className="block text-white font-medium mb-2 flex items-center gap-2 text-sm sm:text-base">
                    <Zap className="w-4 h-4" />
                    2025 트렌드 요소
                  </label>
                  <div className="space-y-2">
                    {trendElements.map((element) => (
                      <label key={element.value} className="flex items-start gap-3 p-2 sm:p-3 rounded-lg bg-white/10 hover:bg-white/20 cursor-pointer transition-colors">
                        <input
                          type="radio"
                          name="trendElement"
                          value={element.value}
                          checked={formData.trendElement === element.value}
                          onChange={(e) => handleInputChange('trendElement', e.target.value)}
                          className="text-blue-500 mt-1"
                        />
                        <div>
                          <div className="text-white font-medium text-sm sm:text-base">{element.label}</div>
                          <div className="text-gray-300 text-xs sm:text-sm">{element.desc}</div>
                        </div>
                      </label>
                    ))}
                  </div>
                </div>

                {/* Generate Button */}
                <button
                  onClick={generateMention}
                  className="w-full bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold py-3 sm:py-4 px-4 sm:px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-base sm:text-lg"
                >
                  <Sparkles className="w-4 sm:w-5 h-4 sm:h-5" />
                  트렌드 멘션 생성하기
                  <RefreshCw className="w-4 sm:w-5 h-4 sm:h-5" />
                </button>
              </div>
            </div>

            {/* Generated Mention */}
            <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-4 sm:p-6 border border-white/20">
              <h2 className="text-xl sm:text-2xl font-semibold text-white mb-4 sm:mb-6 flex items-center gap-2">
                <Target className="w-5 sm:w-6 h-5 sm:h-6" />
                생성된 멘션
              </h2>

              {generatedMention ? (
                <div className="space-y-3 sm:space-y-4">
                  {/* 편집 모드가 아닐 때 */}
                  {!editMode ? (
                    <div className="bg-white/20 rounded-lg p-3 sm:p-4 min-h-[250px] sm:min-h-[300px]">
                      <pre className="text-white whitespace-pre-wrap font-medium leading-relaxed text-sm sm:text-base">
                        {editedMention || generatedMention}
                      </pre>
                    </div>
                  ) : (
                    /* 편집 모드일 때 */
                    <div className="bg-white/20 rounded-lg p-3 sm:p-4">
                      <textarea
                        value={editedMention}
                        onChange={(e) => setEditedMention(e.target.value)}
                        className="w-full h-64 sm:h-80 bg-transparent text-white placeholder-gray-300 border-none outline-none resize-none font-medium leading-relaxed text-sm sm:text-base"
                        placeholder="멘션을 편집해주세요..."
                      />
                    </div>
                  )}
                  
                  {/* 편집/확인 버튼들 */}
                  <div className="flex gap-2">
                    {!editMode ? (
                      <>
                        <button
                          onClick={handleEditMode}
                          className="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 sm:py-3 px-3 sm:px-4 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base"
                        >
                          <Edit3 className="w-4 sm:w-5 h-4 sm:h-5" />
                          편집하기
                        </button>
                        <button
                          onClick={() => copyToClipboard(editedMention || generatedMention)}
                          className={`flex-1 py-2 sm:py-3 px-3 sm:px-4 rounded-lg font-semibold transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base ${
                            copied 
                              ? 'bg-green-500 text-white' 
                              : 'bg-white text-gray-800 hover:bg-gray-100'
                          }`}
                        >
                          <Copy className="w-4 sm:w-5 h-4 sm:h-5" />
                          {copied ? '복사 완료!' : '복사하기'}
                        </button>
                      </>
                    ) : (
                      <>
                        <button
                          onClick={handleSaveEdit}
                          className="flex-1 bg-green-500 hover:bg-green-600 text-white font-semibold py-2 sm:py-3 px-3 sm:px-4 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base"
                        >
                          <Check className="w-4 sm:w-5 h-4 sm:h-5" />
                          편집 완료
                        </button>
                        <button
                          onClick={handleCancelEdit}
                          className="flex-1 bg-gray-500 hover:bg-gray-600 text-white font-semibold py-2 sm:py-3 px-3 sm:px-4 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base"
                        >
                          취소
                        </button>
                      </>
                    )}
                  </div>

                  {/* 번역 버튼 (편집 모드가 아닐 때만 표시) */}
                  {!editMode && (editedMention || generatedMention) && (
                    <button
                      onClick={handleTranslate}
                      disabled={translating}
                      className="w-full bg-gradient-to-r from-green-500 to-teal-600 hover:from-green-600 hover:to-teal-700 disabled:from-gray-400 disabled:to-gray-500 text-white font-semibold py-2 sm:py-3 px-3 sm:px-4 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base"
                    >
                      <Globe className="w-4 sm:w-5 h-4 sm:h-5" />
                      {translating ? '번역 중...' : '영문으로 번역하기'}
                      {translating && <RefreshCw className="w-4 sm:w-5 h-4 sm:h-5 animate-spin" />}
                    </button>
                  )}

                  {/* 번역 결과 */}
                  {translatedMention && (
                    <div className="bg-green-500/20 border border-green-500/30 rounded-lg p-3 sm:p-4">
                      <div className="flex items-center gap-2 mb-3">
                        <Globe className="w-4 sm:w-5 h-4 sm:h-5 text-green-400" />
                        <span className="text-green-300 font-semibold text-sm sm:text-base">영문 번역 결과</span>
                      </div>
                      <div className="bg-white/20 rounded-lg p-3 sm:p-4 mb-3">
                        <pre className="text-white whitespace-pre-wrap font-medium leading-relaxed text-sm sm:text-base">
                          {translatedMention}
                        </pre>
                      </div>
                      <button
                        onClick={() => copyToClipboard(translatedMention)}
                        className="w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-2 px-3 sm:px-4 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base"
                      >
                        <Copy className="w-3 sm:w-4 h-3 sm:h-4" />
                        영문 멘션 복사하기
                      </button>
                    </div>
                  )}

                  <div className="bg-yellow-500/20 border border-yellow-500/30 rounded-lg p-3 sm:p-4">
                    <div className="flex items-start gap-2">
                      <Sparkles className="w-4 sm:w-5 h-4 sm:h-5 text-yellow-400 mt-1" />
                      <div>
                        <div className="text-yellow-300 font-semibold mb-1 text-sm sm:text-base">2025 트렌드 팁</div>
                        <div className="text-yellow-100 text-xs sm:text-sm">
                          생성된 멘션은 2025년 유튜브 알고리즘과 사용자 선호도를 반영했습니다. 
                          편집 기능으로 개인적인 터치를 추가하고, 글로벌 진출을 위해 영문 번역도 활용해보세요!
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              ) : (
                <div className="bg-white/10 rounded-lg p-6 sm:p-8 text-center">
                  <Users className="w-12 sm:w-16 h-12 sm:h-16 text-gray-400 mx-auto mb-4" />
                  <p className="text-gray-300 text-base sm:text-lg">
                    정보를 입력하고 '트렌드 멘션 생성하기'를 클릭해주세요
                  </p>
                  <p className="text-gray-400 text-xs sm:text-sm mt-2">
                    2025년 최신 트렌드가 반영된 맞춤 멘션을 제작해드립니다
                  </p>
                </div>
              )}
            </div>
          </div>

          {/* Footer */}
          <div className="mt-6 sm:mt-8 text-center">
            <div className="bg-white/10 backdrop-blur-lg rounded-lg p-3 sm:p-4 border border-white/20">
              <p className="text-blue-200 text-xs sm:text-sm">
                💡 <strong>2025 트렌드 기반:</strong> YouTube Shorts 최적화, 라이브 소통, 스토리텔링, 멘탈 헬스, 커뮤니티 참여
                <br className="hidden sm:block" />
                <span className="block sm:inline mt-1 sm:mt-0">
                  ✨ <strong>새로운 기능:</strong> 멘션 편집, 영문 번역으로 글로벌 진출까지!
                </span>
              </p>
            </div>
            
            {/* 모바일 설치 도움말 */}
            <div className="mt-4 bg-blue-500/20 border border-blue-500/30 rounded-lg p-3 block sm:hidden">
              <div className="text-blue-200 text-xs">
                <div className="font-semibold mb-1">📱 홈 화면에 추가하는 방법</div>
                <div>iPhone: Safari → 공유 → 홈 화면에 추가</div>
                <div>Android: Chrome → 메뉴 → 홈 화면에 추가</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </>
  );
};

export default YoutubeMentionGenerator;
